<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyAuditApp | Pro Accessibility Auditor</title>

    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff9f43">
    <link rel="apple-touch-icon" href="icon-192.png">

    <style>
        :root { --primary: #ff9f43; --bg: #0a0a0a; --card: #161616; --text: #ececec; }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; }
        
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .logo { font-size: 1.8rem; font-weight: 800; color: var(--primary); letter-spacing: -1px; }
        
        .audit-card { background: var(--card); border-radius: 16px; padding: 25px; border: 1px solid #333; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
        textarea { width: 100%; height: 250px; background: #000; color: #00ff41; border: 1px solid #444; border-radius: 8px; padding: 15px; font-family: 'Courier New', monospace; font-size: 14px; margin-top: 15px; box-sizing: border-box; outline: none; }
        textarea:focus { border-color: var(--primary); }
        
        .btn-run { background: var(--primary); color: #000; border: none; padding: 15px 30px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; margin-top: 15px; transition: opacity 0.2s; }
        .btn-run:hover { opacity: 0.9; }
        
        #results { margin-top: 25px; display: none; }
        .error-item { background: #2a1515; border-left: 4px solid #ff4444; padding: 15px; margin-bottom: 10px; border-radius: 4px; }
        .pass-msg { color: #00ff41; font-weight: bold; text-align: center; background: #152a1a; padding: 15px; border-radius: 8px; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="logo">MyAuditApp <span style="font-size: 0.8rem; vertical-align: middle; opacity: 0.7;">PRO</span></div>
    </header>

    <div class="audit-card">
        <h3>HTML & Accessibility Auditor</h3>
        <p style="color: #888;">Paste your code below to run the professional audit scan.</p>
        
        <textarea id="htmlInput" placeholder="<html>
  <body>
    <h1>Welcome</h1>
    <img src='logo.png'> 
  </body>
</html>"></textarea>
        
        <button class="btn-run" onclick="runAudit()">Run Professional Scan</button>
    </div>

    <div id="results">
        <h3>Audit Results</h3>
        <div id="errorList"></div>
    </div>
</div>

<script>
    // THE AUDIT ENGINE
    function runAudit() {
        const input = document.getElementById('htmlInput').value.trim();
        const errorList = document.getElementById('errorList');
        const resultsDiv = document.getElementById('results');
        
        if (!input) {
            alert("Please paste some HTML code first!");
            return;
        }

        errorList.innerHTML = '';
        resultsDiv.style.display = 'block';
        
        let errors = [];

        // 1. Check for missing Alt text on images
        const imgRegex = /<img[^>]*>/g;
        const imgs = input.match(imgRegex) || [];
        imgs.forEach(img => {
            if (!img.toLowerCase().includes('alt=')) {
                errors.push("Accessibility: Image found missing 'alt' attribute.");
            }
        });

        // 2. Check for missing Lang attribute
        if (!input.toLowerCase().includes('lang=')) {
            errors.push("SEO/Access: Missing 'lang' attribute in <html> tag.");
        }

        // 3. Check for Headings
        if (!input.toLowerCase().includes('<h1')) {
            errors.push("SEO: No H1 heading found. Every page needs one.");
        }

        // Display results
        if (errors.length > 0) {
            errors.forEach(err => {
                const div = document.createElement('div');
                div.className = 'error-item';
                div.innerText = "❌ " + err;
                errorList.appendChild(div);
            });
        } else {
            errorList.innerHTML = "<div class='pass-msg'>✅ Audit Passed! No major accessibility errors found.</div>";
        }
        
        // Auto-scroll to results
        resultsDiv.scrollIntoView({ behavior: 'smooth' });
    }

    // UPDATED SERVICE WORKER REGISTRATION
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            // Changed path to 'sw.js' to work relative to the current folder
            navigator.serviceWorker.register('sw.js')
            .then(reg => console.log('✅ Service Worker Active:', reg.scope))
            .catch(err => console.error('❌ Service Worker Registration Failed:', err));
        });
    }
</script>

</body>
</html>