<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://generativelanguage.googleapis.com; style-src 'self' 'unsafe-inline'; connect-src 'self' https://generativelanguage.googleapis.com;">
  <title>AppAudit Guardian</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root { --accent: #ff9f43; --bg: #0f0f0f; --text: #eee; --success: #1dd1a1; --error: #ff6b6b; }
    body { background: var(--bg); color: var(--text); font-family: system-ui, sans-serif; margin: 0; display: flex; flex-direction: column; height: 100dvh; overflow: hidden; }
    header { padding: 15px; background: #1a1a1a; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
    #container { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 20px; }
    .hidden { display: none !important; }
    textarea, #fix-result { background: #161616; color: #dcdcdc; border: 1px solid #333; border-radius: 8px; padding: 10px; font-family: monospace; font-size: 13px; min-height: 250px; width: 100%; box-sizing: border-box; resize: none; }
    
    /* Responsive Grid for iPhone vs Laptop */
    .result-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
    @media (min-width: 768px) { .result-grid { grid-template-columns: 1fr 1fr; } }
    
    #live-preview { width: 100%; height: 300px; background: white; border-radius: 8px; border: none; }
    .btn-primary { background: var(--accent); color: #000; font-weight: bold; padding: 12px; border: none; border-radius: 6px; cursor: pointer; width: 100%; }
    #debug-log { color: #0f0; font-family: monospace; font-size: 10px; padding: 10px; background: #000; }
  </style>
</head>
<body>
    <header>
        <h1 style="font-size:16px; margin:0;">AppAudit <span style="color:var(--accent)">2.5-FLASH</span></h1>
        <button id="settings-btn" style="background:none; border:none; font-size:20px;">‚öôÔ∏è</button>
    </header>
    <div id="container">
        <div id="sec-input" class="section">
            <textarea id="code-in" placeholder="Paste code here..."></textarea>
            <button id="btn-run" class="btn-primary" style="margin-top:10px;">üîç AUDIT & AUTO-FIX</button>
        </div>
        <div id="status-deck" style="display:none; text-align:center; padding:20px;"></div>
        <div id="sec-result" class="section hidden">
            <div class="result-grid">
                <div id="fix-result"></div>
                <iframe id="live-preview"></iframe>
            </div>
            <button id="btn-copy" class="btn-primary">üìã COPY CODE</button>
            <button onclick="location.reload()" style="background:#333; color:white; padding:10px; border:none; border-radius:6px; margin-top:10px;">NEW PROJECT</button>
            <div id="patch-notes" style="margin-top:20px;"></div>
        </div>
        <div id="debug-log">> READY.</div>
    </div>
    <div id="settings-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:100; align-items:center; justify-content:center;">
        <div style="background:#222; padding:20px; border-radius:12px; width:80%;">
            <input type="password" id="api-key-input" placeholder="Gemini API Key" style="width:100%; padding:10px; box-sizing:border-box;">
            <button id="btn-save-key" class="btn-primary" style="margin-top:10px;">SAVE</button>
        </div>
    </div>
    <script src="./app.js" defer></script>
</body>
</html>
